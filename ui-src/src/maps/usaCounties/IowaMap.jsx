import React, { useState, useMemo } from "react";
import useGameStore from "../../store";
import {
  getMapThemeColors,
  getRegionStyle,
  calculateHeatmapRange,
} from "../../utils/mapHeatmapUtils";
import "../JapanMap.css";

const COUNTY_DATA = {
  Adair: { gameId: "USA_IA_001", name: "Adair" },
  Adams: { gameId: "USA_IA_003", name: "Adams" },
  Allamakee: { gameId: "USA_IA_005", name: "Allamakee" },
  Appanoose: { gameId: "USA_IA_007", name: "Appanoose" },
  Audubon: { gameId: "USA_IA_009", name: "Audubon" },
  Benton: { gameId: "USA_IA_011", name: "Benton" },
  "Black Hawk": { gameId: "USA_IA_013", name: "Black Hawk" },
  Boone: { gameId: "USA_IA_015", name: "Boone" },
  Bremer: { gameId: "USA_IA_017", name: "Bremer" },
  Buchanan: { gameId: "USA_IA_019", name: "Buchanan" },
  "Buena Vista": { gameId: "USA_IA_021", name: "Buena Vista" },
  Butler: { gameId: "USA_IA_023", name: "Butler" },
  Calhoun: { gameId: "USA_IA_025", name: "Calhoun" },
  Carroll: { gameId: "USA_IA_027", name: "Carroll" },
  Cass: { gameId: "USA_IA_029", name: "Cass" },
  Cedar: { gameId: "USA_IA_031", name: "Cedar" },
  "Cerro Gordo": { gameId: "USA_IA_033", name: "Cerro Gordo" },
  Cherokee: { gameId: "USA_IA_035", name: "Cherokee" },
  Chickasaw: { gameId: "USA_IA_037", name: "Chickasaw" },
  Clarke: { gameId: "USA_IA_039", name: "Clarke" },
  Clay: { gameId: "USA_IA_041", name: "Clay" },
  Clayton: { gameId: "USA_IA_043", name: "Clayton" },
  Clinton: { gameId: "USA_IA_045", name: "Clinton" },
  Crawford: { gameId: "USA_IA_047", name: "Crawford" },
  Dallas: { gameId: "USA_IA_049", name: "Dallas" },
  Davis: { gameId: "USA_IA_051", name: "Davis" },
  Decatur: { gameId: "USA_IA_053", name: "Decatur" },
  Delaware: { gameId: "USA_IA_055", name: "Delaware" },
  "Des Moines": { gameId: "USA_IA_057", name: "Des Moines" },
  Dickinson: { gameId: "USA_IA_059", name: "Dickinson" },
  Dubuque: { gameId: "USA_IA_061", name: "Dubuque" },
  Emmet: { gameId: "USA_IA_063", name: "Emmet" },
  Fayette: { gameId: "USA_IA_065", name: "Fayette" },
  Floyd: { gameId: "USA_IA_067", name: "Floyd" },
  Franklin: { gameId: "USA_IA_069", name: "Franklin" },
  Fremont: { gameId: "USA_IA_071", name: "Fremont" },
  Greene: { gameId: "USA_IA_073", name: "Greene" },
  Grundy: { gameId: "USA_IA_075", name: "Grundy" },
  Guthrie: { gameId: "USA_IA_077", name: "Guthrie" },
  Hamilton: { gameId: "USA_IA_079", name: "Hamilton" },
  Hancock: { gameId: "USA_IA_081", name: "Hancock" },
  Hardin: { gameId: "USA_IA_083", name: "Hardin" },
  Harrison: { gameId: "USA_IA_085", name: "Harrison" },
  Henry: { gameId: "USA_IA_087", name: "Henry" },
  Howard: { gameId: "USA_IA_089", name: "Howard" },
  Humboldt: { gameId: "USA_IA_091", name: "Humboldt" },
  Ida: { gameId: "USA_IA_093", name: "Ida" },
  Iowa: { gameId: "USA_IA_095", name: "Iowa" },
  Jackson: { gameId: "USA_IA_097", name: "Jackson" },
  Jasper: { gameId: "USA_IA_099", name: "Jasper" },
  Jefferson: { gameId: "USA_IA_101", name: "Jefferson" },
  Johnson: { gameId: "USA_IA_103", name: "Johnson" },
  Jones: { gameId: "USA_IA_105", name: "Jones" },
  Keokuk: { gameId: "USA_IA_107", name: "Keokuk" },
  Kossuth: { gameId: "USA_IA_109", name: "Kossuth" },
  Lee: { gameId: "USA_IA_111", name: "Lee" },
  Linn: { gameId: "USA_IA_113", name: "Linn" },
  Louisa: { gameId: "USA_IA_115", name: "Louisa" },
  Lucas: { gameId: "USA_IA_117", name: "Lucas" },
  Lyon: { gameId: "USA_IA_119", name: "Lyon" },
  Madison: { gameId: "USA_IA_121", name: "Madison" },
  Mahaska: { gameId: "USA_IA_123", name: "Mahaska" },
  Marion: { gameId: "USA_IA_125", name: "Marion" },
  Marshall: { gameId: "USA_IA_127", name: "Marshall" },
  Mills: { gameId: "USA_IA_129", name: "Mills" },
  Mitchell: { gameId: "USA_IA_131", name: "Mitchell" },
  Monona: { gameId: "USA_IA_133", name: "Monona" },
  Monroe: { gameId: "USA_IA_135", name: "Monroe" },
  Montgomery: { gameId: "USA_IA_137", name: "Montgomery" },
  Muscatine: { gameId: "USA_IA_139", name: "Muscatine" },
  "O'Brien": { gameId: "USA_IA_141", name: "O'Brien" },
  Osceola: { gameId: "USA_IA_143", name: "Osceola" },
  Page: { gameId: "USA_IA_145", name: "Page" },
  "Palo Alto": { gameId: "USA_IA_147", name: "Palo Alto" },
  Plymouth: { gameId: "USA_IA_149", name: "Plymouth" },
  Pocahontas: { gameId: "USA_IA_151", name: "Pocahontas" },
  Polk: { gameId: "USA_IA_153", name: "Polk" },
  Pottawattamie: { gameId: "USA_IA_155", name: "Pottawattamie" },
  Poweshiek: { gameId: "USA_IA_157", name: "Poweshiek" },
  Ringgold: { gameId: "USA_IA_159", name: "Ringgold" },
  Sac: { gameId: "USA_IA_161", name: "Sac" },
  Scott: { gameId: "USA_IA_163", name: "Scott" },
  Shelby: { gameId: "USA_IA_165", name: "Shelby" },
  Sioux: { gameId: "USA_IA_167", name: "Sioux" },
  Story: { gameId: "USA_IA_169", name: "Story" },
  Tama: { gameId: "USA_IA_171", name: "Tama" },
  Taylor: { gameId: "USA_IA_173", name: "Taylor" },
  Union: { gameId: "USA_IA_175", name: "Union" },
  "Van Buren": { gameId: "USA_IA_177", name: "Van Buren" },
  Wapello: { gameId: "USA_IA_179", name: "Wapello" },
  Warren: { gameId: "USA_IA_181", name: "Warren" },
  Washington: { gameId: "USA_IA_183", name: "Washington" },
  Wayne: { gameId: "USA_IA_185", name: "Wayne" },
  Webster: { gameId: "USA_IA_187", name: "Webster" },
  Winnebago: { gameId: "USA_IA_189", name: "Winnebago" },
  Winneshiek: { gameId: "USA_IA_191", name: "Winneshiek" },
  Woodbury: { gameId: "USA_IA_193", name: "Woodbury" },
  Worth: { gameId: "USA_IA_195", name: "Worth" },
  Wright: { gameId: "USA_IA_197", name: "Wright" },
};

const countyPathData = {
  Ringgold:
    "M 261.93 437.61 290.63 438.15 319.23 438.51 318.83 491.98 284.49 492.12 261.27 492 261.77 443.07 261.93 437.61 Z",
  "Buena Vista":
    "M 153.88 102.99 194.67 103.84 211.66 104.12 211.19 133.14 210.75 147.6 210.65 161.97 196.17 161.61 162.34 161 152.65 160.64 153.34 132.07 153.88 102.99 Z",
  Boone:
    "M 302.06 221.08 330.77 221.27 359.49 221.46 359.38 252.35 359.41 278.74 344.83 278.68 322.73 278.64 301.65 278.47 302.06 221.08 Z",
  Clinton:
    "M 705.64 260.24 705.22 245.79 720.79 245.45 748.4 244.53 761.54 243.97 797.08 242.73 798.49 245.69 799 248.8 796.56 254.64 796.46 257.36 798.06 259.6 797.97 263.65 796.12 268.72 795.88 271.88 794.67 275.96 795.22 279.43 794.37 280.92 790.18 282.74 783.36 287.27 779.53 291.57 778.92 293.8 776.68 292.14 774.88 293.79 771.67 293.17 767.42 294.09 765.61 292.34 765.17 290.36 761.93 288.58 759.87 288.87 754.02 287.99 751.15 287.01 750.62 288.67 747.9 288.77 746.1 289.93 744.45 288.09 741.98 290.23 739.73 289.12 737.16 290.84 735.96 289.24 730.4 293.59 728.82 294.2 725.14 293.06 723.48 290.07 720.42 288.75 706.52 289.17 705.64 260.24 Z",
  Union:
    "M 262.43 394.9 291.09 395.26 319.56 395.53 319.23 438.51 290.63 438.15 261.93 437.61 262.43 394.9 Z",
  Butler:
    "M 441.79 105.72 472.64 105.58 499.17 105.32 499.62 149.17 499.8 163.49 470.84 163.77 441.88 163.8 441.79 105.72 Z",
  Osceola:
    "M 98.95 3.86 127.43 4.62 156.06 5.22 155.14 45.81 140.88 45.4 126.53 44.62 97.75 44.02 98.32 29.46 98.95 3.86 Z",
  "Van Buren":
    "M 549.93 436.99 567.46 436.68 589 436.08 607.84 435.74 608.06 450.22 608.83 483.23 609.04 485.79 607.43 483.32 579.87 485.2 550.59 486.5 550.59 472.88 549.93 436.99 Z",
  Emmet:
    "M 213.17 6.2 270.11 7.05 269.99 23.73 269.64 47.7 212.61 46.92 213.17 6.2 Z",
  Hardin:
    "M 383.99 163.81 427.48 163.88 441.88 163.8 441.95 178.05 444.92 178.06 445.31 221.33 416.98 221.52 388.48 221.5 388.52 178.2 384.04 178.17 383.99 163.81 Z",
  Carroll:
    "M 187.99 219.52 216.61 220.13 244.89 220.58 244.27 263.46 244.15 277.96 229.77 277.82 186.69 276.96 187.99 219.52 Z",
  Cherokee:
    "M 96.49 101.73 125.28 102.27 153.88 102.99 153.34 132.07 152.65 160.64 109.34 159.68 94.85 159.41 95.46 132.9 96.19 116.06 96.49 101.73 Z",
  Winnebago:
    "M 327.1 7.6 346.69 7.72 384.25 7.8 384.22 48.25 354.19 48.23 326.92 48.11 327.1 7.6 Z",
  Humboldt:
    "M 269.04 105.17 326.51 105.69 326.22 149.25 299.82 149.07 268.55 148.71 269.04 105.17 Z",
  Lee: "M 608.06 450.22 622.63 449.86 646.98 449.46 649 450.12 652.8 453 661.75 455.77 663.13 458.73 668.02 459.62 671.52 462.19 672.85 464.1 678.64 464.53 680.01 466.28 684.87 467.8 683.55 472.32 675.74 477.81 668.06 477.83 660.71 480.03 655.45 482.9 654.07 484.24 651.68 488.82 648.99 491.37 648.46 494.16 650.79 495.69 653.28 499.03 653.92 503.71 652.36 508.35 652.08 511.83 653.07 514.71 652.92 519.02 651.35 520.2 646.64 520.72 644.65 520.15 639.73 521 637.39 517.72 634 516.33 634.63 512.92 632.76 511.39 633.32 508.37 628.85 508.14 626.73 506.52 624.83 502.6 621.98 501.04 621.27 499.02 621.6 495.37 620.8 494.65 613.62 493.23 612.45 492.12 612.62 488.22 609.04 485.79 608.83 483.23 608.06 450.22 Z",
  "Palo Alto":
    "M 212.61 46.92 269.64 47.7 269.3 84.8 269.04 105.17 211.66 104.12 212.61 46.92 Z",
  "Cerro Gordo":
    "M 384.22 48.25 427.37 48.22 441.6 48.08 441.64 55.16 441.94 84.98 441.79 105.72 412.94 105.81 384.1 105.72 384.2 88.95 384.22 48.25 Z",
  Ida: "M 109.34 159.68 152.65 160.64 152.41 175.03 160.39 175.21 159.34 218.88 145.06 218.61 116.57 217.82 117.03 199 117.85 174.25 108.95 173.99 109.34 159.68 Z",
  Plymouth:
    "M 13.92 99.22 55.62 100.5 79.72 101.08 96.49 101.73 96.19 116.06 95.46 132.9 94.85 159.41 49.09 157.94 23.96 157.01 16.63 156.93 17.19 154 16.16 149.63 14.71 147.77 14.87 145.38 12.33 142.63 12.39 141.15 4.38 133.14 1.87 131.68 2.19 129.18 1 126.69 1.99 124.05 1.14 122.89 3.17 119.51 6.57 116.8 7.99 111.46 11.98 110.43 12.06 106.71 14.98 102.27 13.92 99.22 Z",
  Cass: "M 177.9 336.09 192.08 336.43 234.43 337.19 234.1 365.84 233.64 394.46 205.23 393.96 176.67 393.33 177.54 355.41 177.9 336.09 Z",
  Scott:
    "M 706.52 289.17 720.42 288.75 723.48 290.07 725.14 293.06 728.82 294.2 730.4 293.59 735.96 289.24 737.16 290.84 739.73 289.12 741.98 290.23 744.45 288.09 746.1 289.93 747.9 288.77 750.62 288.67 751.15 287.01 754.02 287.99 759.87 288.87 761.93 288.58 765.17 290.36 765.61 292.34 767.42 294.09 771.67 293.17 774.88 293.79 776.68 292.14 778.92 293.8 779.33 299.43 776.96 302.04 776.05 307.47 776.83 315.45 776.43 317.25 767.91 321.29 762.11 328.41 757.27 329.49 752.21 328.32 745.53 331.05 744.3 333.87 738.26 339.39 732.65 340.79 726.58 341.83 722.06 341.44 721.62 317.66 707.2 318 706.52 289.17 Z",
  Lucas:
    "M 376.73 394.97 405.48 395.05 434.1 394.92 434.5 438.35 391.2 438.61 376.83 438.49 376.73 394.97 Z",
  Franklin:
    "M 384.1 105.72 412.94 105.81 441.79 105.72 441.88 163.8 427.48 163.88 383.99 163.81 384.1 105.72 Z",
  Monroe:
    "M 434.1 394.92 462.82 394.72 491.54 394.43 492.12 437.86 446.74 438.31 434.5 438.35 434.1 394.92 Z",
  Delaware:
    "M 615.52 147.01 630.08 146.68 673.52 145.28 673.71 159.72 674.13 174.18 674.54 174.17 675.43 203.22 646.75 203.84 618.01 204.52 617.33 175.91 615.97 175.93 615.59 161.51 615.52 147.01 Z",
  Floyd:
    "M 441.64 55.16 481.81 54.91 498.6 54.69 499.17 105.32 472.64 105.58 441.79 105.72 441.94 84.98 441.64 55.16 Z",
  Montgomery:
    "M 148.07 392.62 176.67 393.33 205.23 393.96 204.42 436.63 190.12 436.37 147.07 435.39 148.07 392.62 Z",
  Iowa: "M 532.76 277.83 561.7 277.36 580.99 277.25 590.56 277.03 590.82 286.64 590.77 306.03 591.18 320.3 591.93 320.28 591.94 335.02 577.4 335.4 533.65 336.25 533.19 321.07 532.84 298.8 532.76 277.83 Z",
  Calhoun:
    "M 210.65 161.97 239.6 162.59 246.86 162.55 268.4 163 268.25 177.15 273.81 177.22 273.38 220.95 244.89 220.58 216.61 220.13 217.51 176.38 210.42 176.23 210.65 161.97 Z",
  "Black Hawk":
    "M 499.62 149.17 557.46 148.43 557.68 167.6 557.96 177.22 560.08 177.18 560.47 205.48 531.69 205.87 502.82 206.32 502.44 177.75 499.95 177.77 499.8 163.49 499.62 149.17 Z",
  Kossuth:
    "M 269.64 47.7 269.99 23.73 270.11 7.05 292.36 7.31 327.1 7.6 326.92 48.11 326.8 71.94 326.51 105.69 269.04 105.17 269.3 84.8 269.64 47.7 Z",
  Wright:
    "M 326.51 105.69 341 105.62 384.1 105.72 383.99 163.81 340.61 163.76 326.16 163.58 326.22 149.25 326.51 105.69 Z",
  Madison:
    "M 291.59 337.91 306.08 338.12 334.48 338.28 347.75 336.88 347.68 360.94 347.73 394.78 334.01 395.63 319.56 395.53 291.09 395.26 291.59 337.91 Z",
  Buchanan:
    "M 557.46 148.43 576.84 148.14 586.41 147.66 600.96 147.46 615.52 147.01 615.59 161.51 615.97 175.93 617.33 175.91 618.01 204.52 603.56 204.8 589.21 204.67 572.74 205.27 560.47 205.48 560.08 177.18 557.96 177.22 557.68 167.6 557.46 148.43 Z",
  Jefferson:
    "M 549.16 393.49 578.49 392.85 594.06 392.89 607.22 392.43 607.47 417.27 607.84 435.74 589 436.08 567.46 436.68 549.93 436.99 549.16 393.49 Z",
  Marion:
    "M 405.27 337.59 462.2 337.22 462.55 376.65 462.82 394.72 434.1 394.92 405.48 395.05 405.3 340.41 405.27 337.59 Z",
  Crawford:
    "M 116.57 217.82 145.06 218.61 159.34 218.88 187.99 219.52 186.69 276.96 158.1 276.26 147.55 276.18 129.19 275.74 114.89 275.44 116.57 217.82 Z",
  Taylor:
    "M 204.42 436.63 232.61 437.18 261.93 437.61 261.77 443.07 261.27 492 240.96 491.69 205.25 490.53 205.52 475.48 205.88 465.35 203.94 465.3 204.42 436.63 Z",
  Tama: "M 502.82 206.32 531.69 205.87 532.15 241.96 532.61 258.67 532.76 277.83 503.67 278.29 474.83 278.55 474.66 257.01 474.16 220.98 473.96 206.65 502.82 206.32 Z",
  Guthrie:
    "M 229.77 277.82 244.15 277.96 287.3 278.39 286.94 321.71 291.75 321.8 291.59 337.91 257.65 337.54 234.43 337.19 234.64 320.97 229.24 320.89 229.72 287.25 229.77 277.82 Z",
  Greene:
    "M 244.89 220.58 273.38 220.95 302.06 221.08 301.65 278.47 287.3 278.39 244.15 277.96 244.27 263.46 244.89 220.58 Z",
  Worth:
    "M 384.25 7.8 412.79 7.8 441.35 7.63 441.6 48.08 427.37 48.22 384.22 48.25 384.25 7.8 Z",
  Benton:
    "M 531.69 205.87 560.47 205.48 572.74 205.27 589.21 204.67 589.34 233.55 589.53 248.06 590.56 277.03 580.99 277.25 561.7 277.36 532.76 277.83 532.61 258.67 532.15 241.96 531.69 205.87 Z",
  Harrison:
    "M 114.89 275.44 129.19 275.74 128.06 318.94 135.56 319.12 135.17 335.05 115.7 334.59 78.17 333.51 73.16 333.3 73.52 330.59 72.84 327.91 69.52 327.66 68.14 332.81 66.01 332.78 61.36 328.49 61.28 324.46 62.91 321.86 62.68 320.35 59.51 318.01 58.56 315.81 59.06 313.51 61.55 309.71 61.02 307.43 58.48 304.57 58.96 301.88 60.56 300.98 64.18 300.8 63.8 298.09 61.01 296.34 60.84 293.65 63.36 292.22 64.36 288.19 65.79 286.4 65.46 283.97 60.85 280.99 60.91 277.74 59.95 275.3 57.19 273.33 76.47 274.36 114.89 275.44 Z",
  Jasper:
    "M 402.76 278.79 417.14 278.82 445.88 278.73 474.83 278.55 475.1 321.75 476.3 321.73 476.5 337.06 462.2 337.22 405.27 337.59 405.23 322.15 402.75 322.18 402.76 278.79 Z",
  Lyon: "M 98.95 3.86 98.32 29.46 97.75 44.02 76.28 43.19 69.14 43.23 40.55 42.29 13.82 41 11.22 39.53 10.87 36.09 15.71 35.17 17.68 32.44 16.69 28.43 18.03 26.69 17.78 23.22 18.34 18.82 16.76 18.71 12.49 14.56 12.37 12.48 10.08 12 9.52 8.18 11.7 6.6 11.38 2.6 9.91 1 67.22 2.93 98.95 3.86 Z",
  Grundy:
    "M 441.88 163.8 470.84 163.77 499.8 163.49 499.95 177.77 502.44 177.75 502.82 206.32 473.96 206.65 474.16 220.98 445.31 221.33 444.92 178.06 441.95 178.05 441.88 163.8 Z",
  Jones:
    "M 647.85 261.62 647.2 230.25 646.75 203.84 675.43 203.22 703.97 202.49 705.22 245.79 705.64 260.24 676.75 260.97 647.85 261.62 Z",
  Clarke:
    "M 319.56 395.53 334.01 395.63 347.73 394.78 376.73 394.97 376.83 438.49 347.86 438.26 332.44 438.63 319.23 438.51 319.56 395.53 Z",
  Keokuk:
    "M 519.4 336.48 533.65 336.25 577.4 335.4 577.8 364.06 578.43 383.18 578.49 392.85 549.16 393.49 520.34 394 519.4 336.48 Z",
  Davis:
    "M 492.12 437.86 516.14 437.57 549.93 436.99 550.59 472.88 550.59 486.5 525.37 487.52 512.13 487.95 492.78 488.83 492.12 437.86 Z",
  Adair:
    "M 234.43 337.19 257.65 337.54 291.59 337.91 291.09 395.26 262.43 394.9 233.64 394.46 234.1 365.84 234.43 337.19 Z",
  Hamilton:
    "M 326.16 163.58 340.61 163.76 383.99 163.81 384.04 178.17 388.52 178.2 388.48 221.5 359.49 221.46 330.77 221.27 330.97 177.87 326.08 177.83 326.16 163.58 Z",
  Hancock:
    "M 326.92 48.11 354.19 48.23 384.22 48.25 384.2 88.95 384.1 105.72 341 105.62 326.51 105.69 326.8 71.94 326.92 48.11 Z",
  Cedar:
    "M 648.16 276.07 647.85 261.62 676.75 260.97 705.64 260.24 706.52 289.17 707.2 318 675.64 318.82 649.2 319.38 648.16 276.07 Z",
  Audubon:
    "M 186.69 276.96 229.77 277.82 229.72 287.25 229.24 320.89 234.64 320.97 234.43 337.19 192.08 336.43 192.37 320.31 185.94 320.21 186.37 291.26 186.69 276.96 Z",
  Story:
    "M 359.49 221.46 388.48 221.5 416.98 221.52 417.14 278.82 402.76 278.79 359.41 278.74 359.38 252.35 359.49 221.46 Z",
  "Des Moines":
    "M 646.98 449.46 651.68 449.39 650.79 406.13 675.74 405.66 703.59 404.94 704.67 411.2 704.34 415.88 702.94 420.35 703.82 423.89 702.61 429.43 698.22 432.35 695.44 436.42 692.61 439.09 691.22 442.44 687.1 446.48 686.31 448.66 687.1 453.92 685.16 458.74 684.32 463.03 684.87 467.8 680.01 466.28 678.64 464.53 672.85 464.1 671.52 462.19 668.02 459.62 663.13 458.73 661.75 455.77 652.8 453 649 450.12 646.98 449.46 Z",
  Fayette:
    "M 556.76 104.56 556.34 75.45 583.88 75.11 614.15 74.54 614.85 117.87 615.31 133.75 615.52 147.01 600.96 147.46 586.41 147.66 576.84 148.14 557.46 148.43 556.76 104.56 Z",
  Page: "M 147.07 435.39 190.12 436.37 204.42 436.63 203.94 465.3 205.88 465.35 205.52 475.48 205.25 490.53 195.56 490.26 147.31 488.54 147.58 476.15 148.25 464.1 146.41 464.04 147.07 435.39 Z",
  Dickinson: "M 156.06 5.22 213.17 6.2 212.61 46.92 155.14 45.81 156.06 5.22 Z",
  Mahaska:
    "M 462.2 337.22 476.5 337.06 519.4 336.48 520.34 394 491.54 394.43 462.82 394.72 462.55 376.65 462.2 337.22 Z",
  Allamakee:
    "M 611.97 5.15 659.42 4.03 659.78 6.63 657.84 10.79 658.32 13.18 661.53 17.36 662.29 21.39 660.36 26.33 661.99 29.06 664.51 29.52 670.89 32.6 673.6 34.63 676.31 38.16 679.85 44.35 677.38 48.67 672.68 53.43 669.94 60.79 665.86 65.46 666.16 73.51 614.15 74.54 613.37 31.41 612.54 31.41 611.97 5.15 Z",
  Monona:
    "M 32.15 214.76 57.01 215.76 73.59 216.61 116.57 217.82 114.89 275.44 76.47 274.36 57.19 273.33 54.55 267.36 57.03 265.19 56.99 261.55 58.89 255.93 55.59 254.42 52.15 254.89 51.22 253.57 51.83 249.97 48.48 249.81 46.62 251.78 45.59 248.79 47.53 247.13 45.8 244.03 43.6 244.46 41.74 243.25 40.95 238.42 42.48 234.8 42.59 232.47 41.19 230.23 37.44 228.62 36.35 226.24 32.98 222.79 33.09 218.17 32.15 214.76 Z",
  Chickasaw:
    "M 498.6 54.69 529.64 54.31 556 53.89 556.34 75.45 556.76 104.56 551.45 104.69 499.17 105.32 498.6 54.69 Z",
  Washington:
    "M 577.4 335.4 591.94 335.02 615.81 334.65 630.46 334.28 630.67 336.55 632.53 337.16 632.79 339.78 631.28 341.56 633.28 342.79 635.25 348.6 635.85 384.65 636.04 391.86 621.63 392 607.22 392.43 594.06 392.89 578.49 392.85 578.43 383.18 577.8 364.06 577.4 335.4 Z",
  Mitchell:
    "M 441.35 7.63 498.23 7.08 498.32 26.07 498.6 54.69 481.81 54.91 441.64 55.16 441.6 48.08 441.35 7.63 Z",
  Clayton:
    "M 614.15 74.54 666.16 73.51 666.65 80.38 670.41 92.76 670.12 96.6 670.7 101.62 676.37 105.9 677.64 111.37 677.26 113.85 679.3 115 679.47 118.5 681.23 126.64 683.06 129.92 689.98 133.58 691.88 135.97 695.38 137.88 699.21 138 702.22 139.59 702.3 144.48 673.52 145.28 630.08 146.68 615.52 147.01 615.31 133.75 614.85 117.87 614.15 74.54 Z",
  Webster:
    "M 268.55 148.71 299.82 149.07 326.22 149.25 326.16 163.58 326.08 177.83 330.97 177.87 330.77 221.27 302.06 221.08 273.38 220.95 273.81 177.22 268.25 177.15 268.4 163 268.55 148.71 Z",
  Dallas:
    "M 287.3 278.39 301.65 278.47 322.73 278.64 344.83 278.68 344.91 302.68 344.85 322.21 347.79 322.23 347.75 336.88 334.48 338.28 306.08 338.12 291.59 337.91 291.75 321.8 286.94 321.71 287.3 278.39 Z",
  Sac: "M 152.65 160.64 162.34 161 196.17 161.61 210.65 161.97 210.42 176.23 217.51 176.38 216.61 220.13 187.99 219.52 159.34 218.88 160.39 175.21 152.41 175.03 152.65 160.64 Z",
  Johnson:
    "M 590.56 277.03 605.03 276.72 633.84 276.46 648.16 276.07 649.2 319.38 649.65 348.37 635.25 348.6 633.28 342.79 631.28 341.56 632.79 339.78 632.53 337.16 630.67 336.55 630.46 334.28 615.81 334.65 591.94 335.02 591.93 320.28 591.18 320.3 590.77 306.03 590.82 286.64 590.56 277.03 Z",
  "O'Brien":
    "M 97.75 44.02 126.53 44.62 140.88 45.4 155.14 45.81 154.77 64.55 154.13 88.71 153.88 102.99 125.28 102.27 96.49 101.73 97.16 72.81 97.51 51.09 97.75 44.02 Z",
  Pocahontas:
    "M 211.66 104.12 269.04 105.17 268.55 148.71 268.4 163 246.86 162.55 239.6 162.59 210.65 161.97 210.75 147.6 211.19 133.14 211.66 104.12 Z",
  Shelby:
    "M 129.19 275.74 147.55 276.18 158.1 276.26 186.69 276.96 186.37 291.26 185.94 320.21 192.37 320.31 192.08 336.43 177.9 336.09 135.17 335.05 135.56 319.12 128.06 318.94 129.19 275.74 Z",
  Marshall:
    "M 416.98 221.52 445.31 221.33 474.16 220.98 474.66 257.01 474.83 278.55 445.88 278.73 417.14 278.82 416.98 221.52 Z",
  Pottawattamie:
    "M 73.16 333.3 78.17 333.51 115.7 334.59 135.17 335.05 177.9 336.09 177.54 355.41 176.67 393.33 148.07 392.62 105.12 391.61 85.93 391.06 87.09 389.79 89.47 390.31 90.96 388.76 88.08 386.48 82.44 386.97 80.46 385.04 80.66 382.48 82.48 378.1 81.33 374.67 82.3 372.56 80.51 370.86 80.74 368.05 83.45 367.71 82.53 371.23 83.75 372.27 86.3 371.02 87.72 368.67 85.68 364.76 81.08 364.12 77.74 361.09 77.32 359.54 80.61 357.07 80.02 351.8 80.83 350.2 80.64 346.35 82.35 342.73 80.83 340.66 76.77 340.6 71.93 339 70.15 336.58 73.16 333.3 Z",
  Fremont:
    "M 93.23 434.06 106.87 434.46 147.07 435.39 146.41 464.04 148.25 464.1 147.58 476.15 147.31 488.54 128.19 487.84 113.5 487.14 97.88 486.58 99.49 485.36 99.79 482.68 97.49 480.08 97.39 477.6 95.19 474.23 91.01 472.82 88.55 471.06 86.6 465.94 83.64 464.29 82.98 461.91 83.72 459.28 85.49 457.37 89.73 454.7 88.99 450.16 89.96 444.96 88.76 440.13 93.33 436.96 93.23 434.06 Z",
  Appanoose:
    "M 434.5 438.35 446.74 438.31 492.12 437.86 492.78 488.83 477.69 489.29 454.44 489.66 434.78 490.38 434.5 438.35 Z",
  Polk: "M 344.83 278.68 359.41 278.74 402.76 278.79 402.75 322.18 405.23 322.15 405.27 337.59 405.3 340.41 403.94 341.75 396.81 339.51 394.66 337.68 377.92 337.03 347.75 336.88 347.79 322.23 344.85 322.21 344.91 302.68 344.83 278.68 Z",
  Adams:
    "M 205.23 393.96 233.64 394.46 262.43 394.9 261.93 437.61 232.61 437.18 204.42 436.63 205.23 393.96 Z",
  Linn: "M 589.21 204.67 603.56 204.8 618.01 204.52 646.75 203.84 647.2 230.25 647.85 261.62 648.16 276.07 633.84 276.46 605.03 276.72 590.56 277.03 589.53 248.06 589.34 233.55 589.21 204.67 Z",
  Bremer:
    "M 499.17 105.32 551.45 104.69 556.76 104.56 557.46 148.43 499.62 149.17 499.17 105.32 Z",
  Muscatine:
    "M 649.65 348.37 649.2 319.38 675.64 318.82 707.2 318 721.62 317.66 722.06 341.44 715.68 341.18 713.18 341.73 707.94 345.46 704.31 347.19 698.62 345.27 692.11 347.18 689.68 349.35 689.33 353.6 687.72 356.32 687.03 362.22 649.9 362.79 649.65 348.37 Z",
  Sioux:
    "M 13.82 41 40.55 42.29 69.14 43.23 76.28 43.19 97.75 44.02 97.51 51.09 97.16 72.81 96.49 101.73 79.72 101.08 55.62 100.5 13.92 99.22 13.55 96.6 17.52 93.32 18.72 91 16.39 87.89 20.05 82.7 17.79 80.14 18.02 75.97 20.45 75.91 22.15 74.05 24.11 73.84 24.85 72.04 24.32 68.72 27 65.67 26.61 62.36 23.9 59.54 24.28 54.29 23.7 50.44 22.05 47.22 17.89 48.16 17.01 47.07 13.63 46.5 11.73 44.42 13.98 43.12 13.82 41 Z",
  Henry:
    "M 607.84 435.74 607.47 417.27 607.22 392.43 621.63 392 636.04 391.86 650.49 391.71 650.79 406.13 651.68 449.39 646.98 449.46 622.63 449.86 608.06 450.22 607.84 435.74 Z",
  Howard:
    "M 498.23 7.08 555.37 6.21 556 53.89 529.64 54.31 498.6 54.69 498.32 26.07 498.23 7.08 Z",
  Louisa:
    "M 635.25 348.6 649.65 348.37 649.9 362.79 687.03 362.22 686.48 367.5 684.73 370.02 682.14 376.19 682.24 377.62 688.4 384.38 691.61 389.82 695.85 389.69 698.15 391.36 701.29 397.25 703.82 400.97 703.59 404.94 675.74 405.66 650.79 406.13 650.49 391.71 636.04 391.86 635.85 384.65 635.25 348.6 Z",
  Jackson:
    "M 703.97 202.49 732.55 201.68 732.15 187.21 755.63 186.53 759.46 190.75 763.08 196.01 761.5 203.43 763.06 207.31 766.71 211.99 771.03 215.15 774.59 215.75 780.4 219.21 784.39 220.29 789.51 223.21 790.65 226.76 794.43 227.57 795.48 228.94 795.6 233.75 795.07 235.73 795.76 241.29 797.08 242.73 761.54 243.97 748.4 244.53 720.79 245.45 705.22 245.79 703.97 202.49 Z",
  Warren:
    "M 347.75 336.88 377.92 337.03 394.66 337.68 396.81 339.51 403.94 341.75 405.3 340.41 405.48 395.05 376.73 394.97 347.73 394.78 347.68 360.94 347.75 336.88 Z",
  Wapello:
    "M 491.54 394.43 520.34 394 549.16 393.49 549.93 436.99 516.14 437.57 492.12 437.86 491.54 394.43 Z",
  Poweshiek:
    "M 474.83 278.55 503.67 278.29 532.76 277.83 532.84 298.8 533.19 321.07 533.65 336.25 519.4 336.48 476.5 337.06 476.3 321.73 475.1 321.75 474.83 278.55 Z",
  Winneshiek:
    "M 556 53.89 555.37 6.21 611.97 5.15 612.54 31.41 613.37 31.41 614.15 74.54 583.88 75.11 556.34 75.45 556 53.89 Z",
  Wayne:
    "M 376.83 438.49 391.2 438.61 434.5 438.35 434.78 490.38 414.16 490.99 391.29 491.18 376.75 491.12 376.86 460.03 376.83 438.49 Z",
  Dubuque:
    "M 673.52 145.28 702.3 144.48 702.22 139.59 707.7 141.15 717.92 143.05 724 144.63 726.2 146.22 728.33 152.61 731.57 156.44 733.87 161.03 734.98 165.04 732.67 169.04 732.97 171.22 736.72 174.35 743.39 176.97 745.46 181.14 752.32 184.32 755.63 186.53 732.15 187.21 732.55 201.68 703.97 202.49 675.43 203.22 674.54 174.17 674.13 174.18 673.71 159.72 673.52 145.28 Z",
  Mills:
    "M 85.93 391.06 105.12 391.61 148.07 392.62 147.07 435.39 106.87 434.46 93.23 434.06 90.44 430.69 90.04 427.65 91.68 422.32 91.07 420.6 87.38 418.07 86.68 416.06 87.95 413.44 87.78 411.12 85.63 408.76 85.87 406.07 87.9 403.01 87.62 398.12 85.71 393.75 85.93 391.06 Z",
  Decatur:
    "M 319.23 438.51 332.44 438.63 347.86 438.26 376.83 438.49 376.86 460.03 376.75 491.12 359.89 491.49 333.63 491.71 318.83 491.98 319.23 438.51 Z",
  Clay: "M 155.14 45.81 212.61 46.92 211.66 104.12 194.67 103.84 153.88 102.99 154.13 88.71 154.77 64.55 155.14 45.81 Z",
  Woodbury:
    "M 16.63 156.93 23.96 157.01 49.09 157.94 94.85 159.41 109.34 159.68 108.95 173.99 117.85 174.25 117.03 199 116.57 217.82 73.59 216.61 57.01 215.76 32.15 214.76 34.67 214.21 36.28 212.45 35.5 207.53 32.51 204.61 31.11 202.02 31.03 198.86 29.37 196.32 26.5 194.32 25.4 190.75 26.66 187.92 25.96 185.02 26.44 182.14 29.53 178.67 30.45 176.39 29.96 171.72 27.16 169.46 22.12 168.71 19.08 168.85 19.42 166.56 18.73 163.11 19.27 157.85 16.63 156.93 Z",
};

const countyOrderFromSVG = [
  "Ringgold",
  "Buena Vista",
  "Boone",
  "Clinton",
  "Union",
  "Butler",
  "Osceola",
  "Van Buren",
  "Emmet",
  "Hardin",
  "Carroll",
  "Cherokee",
  "Winnebago",
  "Humboldt",
  "Lee",
  "Palo Alto",
  "Cerro Gordo",
  "Ida",
  "Plymouth",
  "Cass",
  "Scott",
  "Lucas",
  "Franklin",
  "Monroe",
  "Delaware",
  "Floyd",
  "Montgomery",
  "Iowa",
  "Calhoun",
  "Black Hawk",
  "Kossuth",
  "Wright",
  "Madison",
  "Buchanan",
  "Jefferson",
  "Marion",
  "Crawford",
  "Taylor",
  "Tama",
  "Guthrie",
  "Greene",
  "Worth",
  "Benton",
  "Harrison",
  "Jasper",
  "Lyon",
  "Grundy",
  "Jones",
  "Clarke",
  "Keokuk",
  "Davis",
  "Adair",
  "Hamilton",
  "Hancock",
  "Cedar",
  "Audubon",
  "Story",
  "Des Moines",
  "Fayette",
  "Page",
  "Dickinson",
  "Mahaska",
  "Allamakee",
  "Monona",
  "Chickasaw",
  "Washington",
  "Mitchell",
  "Clayton",
  "Webster",
  "Dallas",
  "Sac",
  "Johnson",
  "O'Brien",
  "Pocahontas",
  "Shelby",
  "Marshall",
  "Pottawattamie",
  "Fremont",
  "Appanoose",
  "Polk",
  "Adams",
  "Linn",
  "Bremer",
  "Muscatine",
  "Sioux",
  "Henry",
  "Howard",
  "Louisa",
  "Jackson",
  "Warren",
  "Wapello",
  "Poweshiek",
  "Winneshiek",
  "Wayne",
  "Dubuque",
  "Mills",
  "Decatur",
  "Clay",
  "Woodbury",
];

function IowaMap({
  onSelectCounty,
  selectedCountyGameId,
  heatmapData,
  viewType,
}) {
  const [hoveredCountyId, setHoveredCountyId] = useState(null);
  const [tooltipData, setTooltipData] = useState(null);
  const [mousePosition, setMousePosition] = useState({ x: 0, y: 0 });
  const currentTheme = useGameStore(
    (state) => state.availableThemes[state.activeThemeName]
  );

  const themeColors = getMapThemeColors(currentTheme);
  useMemo(
    () => calculateHeatmapRange(heatmapData, viewType),
    [heatmapData, viewType]
  );

  const getCountyStyle = (svgId) => {
    return getRegionStyle({
      regionId: null,
      svgId,
      regionData: COUNTY_DATA,
      heatmapData,
      viewType,
      theme: themeColors,
      hoveredId: hoveredCountyId,
      selectedId: selectedCountyGameId,
      isClickable: !!onSelectCounty,
    });
  };

  const handleCountyClick = (svgId) => {
    const county = COUNTY_DATA[svgId];
    if (county && onSelectCounty) {
      onSelectCounty(county.gameId, county.name);
    } else {
      console.warn(`No game data found for SVG ID: ${svgId}`);
    }
  };

  const handleMouseEnter = (svgId, event) => {
    const countyInfo = COUNTY_DATA[svgId];
    if (!countyInfo) return;

    setHoveredCountyId(countyInfo.gameId);

    if (viewType === "congressional_districts" && heatmapData?.mapData) {
      const mapDataItem = heatmapData.mapData.find(
        (item) => item.id === countyInfo.gameId
      );
      if (mapDataItem) {
        setTooltipData({
          name: countyInfo.name,
          isSplit: mapDataItem.isSplit,
          splitDetails: mapDataItem.splitDetails,
          districtLabel: mapDataItem.value,
        });
      }
    } else {
      setTooltipData({
        name: countyInfo.name,
        isSplit: false,
        splitDetails: null,
        districtLabel: null,
      });
    }

    setMousePosition({ x: event.clientX, y: event.clientY });
  };

  const handleMouseLeave = () => {
    setHoveredCountyId(null);
    setTooltipData(null);
  };

  const handleMouseMove = (event) => {
    setMousePosition({ x: event.clientX, y: event.clientY });
  };

  const renderCountyPath = (svgId) => {
    const countyInfo = COUNTY_DATA[svgId];
    if (!countyInfo) {
      console.warn(`No COUNTY_DATA found for SVG ID: ${svgId}`);
      return null;
    }

    const pathD = countyPathData[svgId];
    if (!pathD) {
      console.warn(`Path data (d attribute) missing for ${svgId}`);
      return null;
    }

    return (
      <path
        key={svgId}
        id={svgId}
        title={countyInfo.name}
        className={`prefecture-path ${
          selectedCountyGameId === countyInfo.gameId ? "selected" : ""
        }`}
        style={getCountyStyle(svgId)}
        onMouseEnter={(e) => handleMouseEnter(svgId, e)}
        onMouseLeave={handleMouseLeave}
        onMouseMove={handleMouseMove}
        onClick={() => handleCountyClick(svgId)}
        d={pathD}
      />
    );
  };

  return (
    <>
      <svg
        version="1.2"
        xmlns="http://www.w3.org/2000/svg"
        viewBox="0 0 810 515"
        className="interactive-japan-map"
        preserveAspectRatio="xMidYMid meet"
      >
        <g
          id="iowa-counties-group"
          stroke="white"
          strokeWidth="1"
          transform="translate(5,5)"
        >
          {countyOrderFromSVG.map((svgId) => renderCountyPath(svgId))}
        </g>
      </svg>
      {tooltipData && (
        <div
          style={{
            position: "fixed",
            left: mousePosition.x + 10,
            top: mousePosition.y - 10,
            backgroundColor: "rgba(0, 0, 0, 0.9)",
            color: "white",
            padding: "8px 12px",
            borderRadius: "4px",
            fontSize: "12px",
            pointerEvents: "none",
            zIndex: 1000,
            maxWidth: "250px",
            boxShadow: "0 2px 8px rgba(0, 0, 0, 0.3)",
          }}
        >
          <div style={{ fontWeight: "bold", marginBottom: "4px" }}>
            {tooltipData.name} County
          </div>

          {tooltipData.isSplit && tooltipData.splitDetails ? (
            <div>
              <div
                style={{
                  color: themeColors.selectedColor || "#ff6b35",
                  fontWeight: "bold",
                  marginBottom: "4px",
                }}
              >
                Split County
              </div>
              <div style={{ fontSize: "11px" }}>
                {tooltipData.splitDetails.map((detail, index) => (
                  <div key={index} style={{ marginBottom: "2px" }}>
                    District {detail.districtId}:{" "}
                    {detail.population.toLocaleString()} people
                  </div>
                ))}
              </div>
            </div>
          ) : (
            tooltipData.districtLabel && (
              <div style={{ fontSize: "11px" }}>
                {tooltipData.districtLabel}
              </div>
            )
          )}
        </div>
      )}
    </>
  );
}

export default IowaMap;
